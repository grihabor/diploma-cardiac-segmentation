\section{Описание практической части}

Проект был~реализован на~языке Python~3. Для реализации моделей использовался фреймворк tensorflow~\cite{tensorflow} и~библиотекa keras~\cite{keras}. Наборы данных были получены в формате DICOM, поэтому для распаковки данных использовалась соответствующая библиотека pydicom~\cite{pydicom}. Обработка данных в памяти осуществлялось с помощью библиотеки numpy~\cite{numpy}. Для работы с изображениями использовалась библиотека OpenCV~\cite{opencv}. Аугментация данных реализована с помощью встроенных в~keras средств для генерации и преобразования изображений налету \texttt{ImageDataGenerator}. Для всех моделей использовалось одинаковое количество эпох. Обучение и тестирование было реализовано с помощью обертки из keras, которая позволяет использовать scikit-learn API с унифицированным интерфейсом для обучения, применения и проверки точности модели.

Решение задачи проходило в несколько этапов:

\begin{itemize}
  \item реализация существующих моделей,
  \item вычисление метрик каждой модели на каждом наборе данных,
  \item анализ результатов,
  \item построение новой модели и подбор параметров,
  \item сравнение результатов новой модели и существующих.
\end{itemize}

Код структурирован в несколько модулей. Часть из них предназначена для чтения данных и приведения их к нормальному виду, как уже было описано ранее. Для каждого набора данных необходимо было немного менять код, чтобы на выходе получались данные в одном формате и одного размера для всех наборов данных.

Код обучения и тестирования модели один и тот же для всех наборов данных и для всех моделей, поэтому он вынесен в отдельный модуль. Для~реализации этих функций использовалась библиотека scikit-learn~\cite{sklearn}, а точнее пакет \texttt{sklearn.model\_selection}.

Каждая модель реализована в отдельном модуле и имеет унифицированный интерфейс. Для использования модели из соответствующего модуля необходимо импортировать функцию-getter, которая возвращает модель. Параметры модели можно задать при вызове функции. Модель представляет собой объект типа \texttt{keras.models.Model}, который построен с помощью Keras Functional API. Сначала задается каждый слой сети со своими параметрами, затем устанавливаются зависимости между слоями. Получившийся граф имеет несколько входов и выходов, на его основе и~создается объект модели. 

После создания модель уже можно использовать для предсказаний. Чтобы использовать модель для обучения, необходимо задать еще несколько параметров: оптимизатор, функцию ошибки, метрики для отслеживания качества модели. В качестве функции ошибки использовалось отрицание индекса Дайса~\eqref{eq:dice_index}, которого нет в библиотеке keras, поэтому оно было реализовывано вручную.
