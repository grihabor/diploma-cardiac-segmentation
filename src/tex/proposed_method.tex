\section{Исследование и построение решения задачи}

\subsection{Наборы данных}

\paragraph{Sunnybrook}

Набор содержит снимки 45 пациентов. У разных пациентов, 
снимки которых присутствуют в наборе, разное состояние здоровья сердца: 
у некоторых заболеваний~нет, у~остальных — разные виды заболеваний. 
Для~обучения присутствует экспертная разметка эндокарда, эпикарда 
и~сосочковых мышц. Набор разделен на 3~части по~15~пациентов 
в~каждом: часть для обучения, для валидации и~для~тестирования.

\paragraph{LVSC}

Набор содержит снимки 200 пациентов. Набор разделен на 2 части пополам: часть для обучения и~часть для~валидации. У всех пациентов присутствует ишемическая болезнь сердца и коронарная недостаточность.

\paragraph{RVSC}

Набор состоит из 48 снимков пациентов с разными заболеваниями сердца. Данные разделены на 3 части: одна для обучения и две для тестирования. Экспертная разметка присутствует только для части для обучения.

\subsection{U-Net с растянутой сверткой}

Для построения собственного решения были проанализированы существующие подходы и нейронные сети для решения задачи семантической сегментации и выделения контура сердца. В этой работе предложена своя архитектура сети, решающая эту задачу.

За основу была взята модель U-Net, потому что она дает хороший результат и ее количество параметров гораздо меньше, чем у GridNet. Идея архитектуры в том, чтобы заменить последовательные свертки в U-Net на последовательные растянутые свертки. В оригинальном U-Net в каждом блоке присутствует 2~сверточных слоя с~ядром~3x3 и~затем maxpool~слой. В~предложенной модели также используется 2~сверточных слоя, но второй из них в каждом блоке вычисляется с~растяжением~2, то~есть~эффективное ядро свертки будет 5x5. Размер контекста входного изображения в U-Net 140x140~\eqref{eq:unet_influence}, а~размер контекста предложенной архитектуры — 202x202~\eqref{eq:dilated_unet_influence}. Это существенно уменьшает возможность появления артефактов и ошибок второго рода.

\begin{equation} 
\label{eq:unet_influence}
1-3-5:10-12-14:28-30-32:64-66-68:136-138-140
\end{equation}
\begin{equation} 
\label{eq:dilated_unet_influence}
1-5-7:14-18-20:40-44-46:92-96-98:196-200-202
\end{equation}

Схемы~\eqref{eq:unet_influence}~и~\eqref{eq:dilated_unet_influence} показывают, как увеличивается контекст при прохождении через сверточные и maxpool слои архитектуры U-Net~и~U-Net с~растянутой сверткой соответственно. Например, запись $5-7$ означает, что при прохождении через сверточный слой контекст увеличился с 5х5 до 7х7, а~запись $20:40$ означает, что при прохождении через maxpoool слой контекст увеличился с 20x20 до 40х40.

\newpage
\subsection{Результаты} 

\begin{table}[h]
  \begin{center}
    \caption{Результаты на наборе данных LVSC} \label{tab:lvsc_results}
    \begin{tabular}{ |c||*{3}{c|} }
      \hline
      \multirow{2}{*}{Метод}      & Количество   & \multicolumn{2}{c|}{Индекс Дайса} \\ \cline{3-4}
                                  & параметров   & Endocardium   & Epicardium        \\ \hline
      \hline
      FCN                         & $\sim11$~млн & 0.90          & 0.89              \\ \hline
      U-Net                       & $\sim31$~млн & 0.92          & \textbf{0.90}     \\ \hline
      GridNet                     &  $\sim8$~млн & \textbf{0.93} & \textbf{0.90}     \\ \hline
      U-Net с~растянутой сверткой & $\sim31$~млн & 0.92          & 0.88              \\ 
      \hline
    \end{tabular}

    \vspace{0.6cm}
    
    \caption{Результаты на наборе данных RVSC} \label{tab:rvsc_results}
    \begin{tabular}{ |c||*{3}{c|} }
      \hline
      \multirow{2}{*}{Метод}      & Количество   & \multicolumn{2}{c|}{Индекс Дайса} \\ \cline{3-4}
                                  & параметров   & Endocardium   & Epicardium        \\ \hline
      \hline
      FCN                         & $\sim11$~млн & 0.84          & \textbf{0.86}     \\ \hline
      U-Net                       & $\sim31$~млн & 0.79          & 0.77              \\ \hline
      GridNet                     &  $\sim8$~млн & 0.82          & 0.81              \\ \hline
      U-Net с~растянутой сверткой & $\sim31$~млн & \textbf{0.85} & 0.83              \\ 
      \hline
    \end{tabular}

    \vspace{0.6cm}
    
    \caption{Результаты на наборе данных Sunnybrook} \label{tab:sunnybrook_results}
    \begin{tabular}{ |c||*{3}{c|} }
      \hline
      \multirow{2}{*}{Метод}      & Количество   & \multicolumn{2}{c|}{Индекс Дайса} \\ \cline{3-4}
                                  & параметров   & Endocardium   & Epicardium        \\ \hline
      \hline
      FCN                         & $\sim11$~млн & 0.92          & \textbf{0.96}     \\ \hline
      U-Net                       & $\sim31$~млн & \textbf{0.93} & 0.94              \\ \hline
      GridNet                     &  $\sim8$~млн & 0.90          & 0.93              \\ \hline
      U-Net с~растянутой сверткой & $\sim31$~млн & 0.91          & \textbf{0.96}     \\ 
      \hline
    \end{tabular}
  \end{center}
\end{table}
