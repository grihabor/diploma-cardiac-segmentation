\section{Постановка задачи}

Целью данной работы является построение алгоритма, который решает задачу сегментации снимков МРТ сердца. Задача сегментации заключается в том, чтобы определить, какие части изображения принадлежат целевому объекту, а какие нет. 

\subsection{Входные данные}

Каждый набор данных разделен на 3 части: 

\begin{itemize}
  \item данные для обучения
  \item данные для валидации
  \item данные для тестирования
\end{itemize}

Данные для обучения и валидации — это пары $(\hat{X}_{train},\hat{Y}_{train})$ и $(\hat{X}_{val},\hat{Y}_{val})$, где $\hat{X}_{train} = \{\hat{x}_{train i}\}, i\in{}\overline{1,n_{train}}$ и $\hat{X}_{val} = \{\hat{x}_{val i}\}, i\in{}\overline{1,n_{val}}$ соответственно — 2 упорядоченных набора матриц, каждый элемент каждой из которых представляет собой интенсивность соответствующего участка на снимке МРТ сердца, $\hat{Y}_{train}$ и $\hat{Y}_{val}$ соответственно — 2 упорядоченных множества пар $(x_{i},y_{i}), i = \overline{1,m}$, определяющее \mbox{$m$-угольник} — выделенный экспертом контур сердца.

Данные для тестирования — упорядоченный набор матриц $\hat{X}_{test} = \{\hat{x}_{test i}\}, i\in{}\overline{1,n_{test}}$, каждый элемент каждой из которых представляет собой интенсивность соответствующего участка на снимке МРТ сердца, для которого необходимо предсказать контур искомого объекта.

\subsection{Формальная постановка задачи}

Чтобы использовать нейронную сеть для решения задачи, преобразуем каждый набор $\hat{X},\hat{X}\in{}\{\hat{X}_{train},\hat{X}_{val},\hat{X}_{test}\}$ к соответствующему новому упорядоченному набору $X,X\in{}\{X_{train},X_{val},X_{test}\}$, каждый элемент которого — матрица $R^{n*n}$, каждый элемент которой, в свою очередь, представляет собой нормализованную интенсивность соответствующего участка на снимке МРТ сердца. 

Аналогично, преобразуем каждый набор $\hat{Y},\hat{Y}\in{}\{\hat{Y}_{train},\hat{Y}_{val}\}$ в соответствующий упорядоченный набор $Y,Y\in{}\{Y_{train},Y_{val}\}$, каждый элемент которого — матрица $R^{n*n}$, каждый элемент которой, в свою очередь, является $1$ или $0$, в зависимости от того, принадлежит ли соответствующий пиксель заданному \mbox{$m$-угольнику} или нет.

Таким образом, исходная задача сводится к задаче бинарной классификации каждого пикселя входного изображения — либо пиксель принадлежит объекту, либо нет. На вход алгоритму подаются нормализованные матрицы снимков МРТ, а на выходе алгоритма получается матрица, каждый элемент которой показывает вероятность принадлежности соответствующего пикселя объекту. Выход алгоритма затем сравнивается с разметкой с помощью различных метрик.

\subsection{Метрики}

Чтобы оценить качество сегментации, введем метрики оценки качества сегментации. Результат сегментации можно представить либо как область пикселей, либо как контур вокруг этой области. 

Индекс Дайса (Dice index) и Индекс Джаккарда (Jaccard index) позволяют сравнить 2 области:

Dice(A,B) = \frac{2|A\cap{}B|}{|A| + |B|}

J(A,B) = \frac{|A\cap{}B|}{|A\cup{}B|}

Метрика Хаусдорфа (Hausdorff distance) позволяет оценить схожесть контуров:

\mathrm{d}_{H}(A,B)=\max\left\{\sup_{a\in{}A}\inf_{b\in{}B}\mathrm{d}(a,b),\sup_{b\in{}B}\inf_{a\in{}A}\mathrm{d}(a,b)\right\}

Чтобы посчитать индекс Джаккарда или индекс Дайса, необходимо предварительно преобразовать экспертную разметку


